<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>39 40 No S Q L入门 | Python-100天从新手到大师</title>


<link rel="stylesheet" href="/python100days/book.min.89885fa0429ec73067282f26fc0c6d38cfc617a443ec4e835d47b821c52c6e92.css" integrity="sha256-iYhfoEKexzBnKC8m/AxtOM/GF6RD7E6DXUe4IcUsbpI=">


<script defer src="/python100days/search.min.60214faf2667d486f5a5c602eb23dff270f5cbd9d003a2a159b89871099dc1b4.js" integrity="sha256-YCFPryZn1Ib1pcYC6yPf8nD1y9nQA6KhWbiYcQmdwbQ="></script>



<link rel="icon" href="/python100days/favicon.png" type="image/x-icon">

<base href="https://ezzdoc.github.io/python100days/">


<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://ezzdoc.github.io/python100days/"><span>Python-100天从新手到大师</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" readonly />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    
  
  
  

  <style>
  nav ul a[href$="\2fpython100days\2f docs\2f Day36-40\2f 39-40-NoSQL%E5%85%A5%E9%97%A8\2f "] {
      color: #004ed0;
  }
  </style>

<ul>
<li><a href="/python100days/posts/"><strong>相关文章</strong></a></li>
<li><strong>Day01-15</strong>

<ul>
<li><a href="/python100days/docs/Day01-15/01-%E5%88%9D%E8%AF%86Python/">01.初识Python</a></li>
<li><a href="/python100days/docs/Day01-15/02-%E8%AF%AD%E8%A8%80%E5%85%83%E7%B4%A0/">02.语言元素</a></li>
<li><a href="/python100days/docs/Day01-15/03-%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84/">03.分支结构</a></li>
<li><a href="/python100days/docs/Day01-15/04-%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84/">04.循环结构</a></li>
<li><a href="/python100days/docs/Day01-15/05-%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91/">05.构造程序逻辑</a></li>
<li><a href="/python100days/docs/Day01-15/06-%E5%87%BD%E6%95%B0%E5%92%8C%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BD%BF%E7%94%A8/">06.函数和模块的使用</a></li>
<li><a href="/python100days/docs/Day01-15/07-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">07.字符串和常用数据结构</a></li>
<li><a href="/python100days/docs/Day01-15/08-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">08.面向对象编程基础</a></li>
<li><a href="/python100days/docs/Day01-15/09-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%BF%9B%E9%98%B6/">09.面向对象进阶</a></li>
<li><a href="/python100days/docs/Day01-15/10-%E5%9B%BE%E5%BD%A2%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2%E5%92%8C%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/">10.图形用户界面和游戏开发</a></li>
<li><a href="/python100days/docs/Day01-15/11-%E6%96%87%E4%BB%B6%E5%92%8C%E5%BC%82%E5%B8%B8/">11.文件和异常</a></li>
<li><a href="/python100days/docs/Day01-15/12-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">12.字符串和正则表达式</a></li>
<li><a href="/python100days/docs/Day01-15/13-%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B/">13.进程和线程</a></li>
<li><a href="/python100days/docs/Day01-15/14-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%85%A5%E9%97%A8%E5%92%8C%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/">14.网络编程入门和网络应用开发</a></li>
<li><a href="/python100days/docs/Day01-15/15-%E5%9B%BE%E5%83%8F%E5%92%8C%E5%8A%9E%E5%85%AC%E6%96%87%E6%A1%A3%E5%A4%84%E7%90%86/">15.图像和办公文档处理</a></li>
</ul></li>
<li><strong>Day16-20</strong>

<ul>
<li><a href="/python100days/docs/Day16-20/16-20-Python%E8%AF%AD%E8%A8%80%E8%BF%9B%E9%98%B6/">16-20.Python语言进阶</a></li>
</ul></li>
<li><strong>Day21-30</strong>

<ul>
<li><a href="/python100days/docs/Day21-30/21-30-Web%E5%89%8D%E7%AB%AF%E6%A6%82%E8%BF%B0/">21-30.Web前端概述</a></li>
</ul></li>
<li><strong>Day31-35</strong>

<ul>
<li><a href="/python100days/docs/Day31-35/31-35-%E7%8E%A9%E8%BD%ACLinux%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">31-35.玩转Linux操作系统</a></li>
</ul></li>
<li><strong>Day36-40</strong>

<ul>
<li><a href="/python100days/docs/Day36-40/36-38-%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93MySQL/">36-38.关系型数据库MySQL</a></li>
<li><a href="/python100days/docs/Day36-40/39-40-NoSQL%E5%85%A5%E9%97%A8/">39-40.NoSQL入门</a></li>
</ul></li>
<li><strong>Day41-55</strong>

<ul>
<li><a href="/python100days/docs/Day41-55/41-%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B/">41.快速上手</a></li>
<li><a href="/python100days/docs/Day41-55/42-%E6%B7%B1%E5%85%A5%E6%A8%A1%E5%9E%8B/">42.深入模型</a></li>
<li><a href="/python100days/docs/Day41-55/43-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%92%8CAjax%E8%AF%B7%E6%B1%82/">43.静态资源和Ajax请求</a></li>
<li><a href="/python100days/docs/Day41-55/44-%E8%A1%A8%E5%8D%95%E7%9A%84%E5%BA%94%E7%94%A8/">44.表单的应用</a></li>
<li><a href="/python100days/docs/Day41-55/45-Cookie%E5%92%8CSession/">45.Cookie和Session</a></li>
<li><a href="/python100days/docs/Day41-55/46-%E6%8A%A5%E8%A1%A8%E5%92%8C%E6%97%A5%E5%BF%97/">46.报表和日志</a></li>
<li><a href="/python100days/docs/Day41-55/47-%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E5%BA%94%E7%94%A8/">47.中间件的应用</a></li>
<li><a href="/python100days/docs/Day41-55/48-%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/">48.前后端分离开发入门</a></li>
<li><a href="/python100days/docs/Day41-55/49-RESTful%E6%9E%B6%E6%9E%84%E5%92%8CDRF%E5%85%A5%E9%97%A8/">49.RESTful架构和DRF入门</a></li>
<li><a href="/python100days/docs/Day41-55/50-RESTful%E6%9E%B6%E6%9E%84%E5%92%8CDRF%E8%BF%9B%E9%98%B6/">50.RESTful架构和DRF进阶</a></li>
<li><a href="/python100days/docs/Day41-55/51-%E4%BD%BF%E7%94%A8%E7%BC%93%E5%AD%98/">51.使用缓存</a></li>
<li><a href="/python100days/docs/Day41-55/52-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91/">52.文件上传和富文本编辑</a></li>
<li><a href="/python100days/docs/Day41-55/53-%E7%9F%AD%E4%BF%A1%E5%92%8C%E9%82%AE%E4%BB%B6/">53.短信和邮件</a></li>
<li><a href="/python100days/docs/Day41-55/54-%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1/">54.异步任务和定时任务</a></li>
<li><a href="/python100days/docs/Day41-55/55-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%92%8C%E9%A1%B9%E7%9B%AE%E4%B8%8A%E7%BA%BF/">55.单元测试和项目上线</a></li>
</ul></li>
<li><strong>Day56-60</strong>

<ul>
<li><a href="/python100days/docs/Day56-60/56-Flask%E5%85%A5%E9%97%A8/">56.Flask入门</a></li>
<li><a href="/python100days/docs/Day56-60/57-%E6%A8%A1%E6%9D%BF%E7%9A%84%E4%BD%BF%E7%94%A8/">57.模板的使用</a></li>
<li><a href="/python100days/docs/Day56-60/58-%E8%A1%A8%E5%8D%95%E7%9A%84%E5%A4%84%E7%90%86/">58.表单的处理</a></li>
<li><a href="/python100days/docs/Day56-60/59-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/">59.数据库操作</a></li>
<li><a href="/python100days/docs/Day56-60/60-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/">60.项目实战</a></li>
</ul></li>
<li><strong>Day61-65</strong>

<ul>
<li><a href="/python100days/docs/Day61-65/61-%E9%A2%84%E5%A4%87%E7%9F%A5%E8%AF%86/">61.预备知识</a></li>
<li><a href="/python100days/docs/Day61-65/62-Tornado%E5%85%A5%E9%97%A8/">62.Tornado入门</a></li>
<li><a href="/python100days/docs/Day61-65/63-%E5%BC%82%E6%AD%A5%E5%8C%96/">63.异步化</a></li>
<li><a href="/python100days/docs/Day61-65/64-WebSocket%E7%9A%84%E5%BA%94%E7%94%A8/">64.WebSocket的应用</a></li>
<li><a href="/python100days/docs/Day61-65/65-%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/">65.项目实战</a></li>
</ul></li>
<li><strong>Day66-75</strong>

<ul>
<li><a href="/python100days/docs/Day66-75/66-%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E5%92%8C%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7/">66.网络爬虫和相关工具</a></li>
<li><a href="/python100days/docs/Day66-75/67-%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E5%92%8C%E8%A7%A3%E6%9E%90/">67.数据采集和解析</a></li>
<li><a href="/python100days/docs/Day66-75/68-%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE/">68.存储数据</a></li>
<li><a href="/python100days/docs/Day66-75/69-%E5%B9%B6%E5%8F%91%E4%B8%8B%E8%BD%BD/">69.并发下载</a></li>
<li><a href="/python100days/docs/Day66-75/70-%E8%A7%A3%E6%9E%90%E5%8A%A8%E6%80%81%E5%86%85%E5%AE%B9/">70.解析动态内容</a></li>
<li><a href="/python100days/docs/Day66-75/71-%E8%A1%A8%E5%8D%95%E4%BA%A4%E4%BA%92%E5%92%8C%E9%AA%8C%E8%AF%81%E7%A0%81%E5%A4%84%E7%90%86/">71.表单交互和验证码处理</a></li>
<li><a href="/python100days/docs/Day66-75/72-Scrapy%E5%85%A5%E9%97%A8/">72.Scrapy入门</a></li>
<li><a href="/python100days/docs/Day66-75/73-Scrapy%E9%AB%98%E7%BA%A7%E5%BA%94%E7%94%A8/">73.Scrapy高级应用</a></li>
<li><a href="/python100days/docs/Day66-75/74-Scrapy%E5%88%86%E5%B8%83%E5%BC%8F%E5%AE%9E%E7%8E%B0/">74.Scrapy分布式实现</a></li>
<li><a href="/python100days/docs/Day66-75/75-%E7%88%AC%E8%99%AB%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/">75.爬虫项目实战</a></li>
</ul></li>
<li><strong>Day76-90</strong>

<ul>
<li><a href="/python100days/docs/Day76-90/76-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/">76.机器学习基础</a></li>
<li><a href="/python100days/docs/Day76-90/77-Pandas%E7%9A%84%E5%BA%94%E7%94%A8/">77.Pandas的应用</a></li>
<li><a href="/python100days/docs/Day76-90/78-NumPy%E5%92%8CSciPy%E7%9A%84%E5%BA%94%E7%94%A8/">78.NumPy和SciPy的应用</a></li>
<li><a href="/python100days/docs/Day76-90/79-Matplotlib%E5%92%8C%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/">79.Matplotlib和数据可视化</a></li>
<li><a href="/python100days/docs/Day76-90/80-k%E6%9C%80%E8%BF%91%E9%82%BB%E5%88%86%E7%B1%BB/">80.k最近邻分类</a></li>
<li><a href="/python100days/docs/Day76-90/81-%E5%86%B3%E7%AD%96%E6%A0%91/">81.决策树</a></li>
<li><a href="/python100days/docs/Day76-90/82-%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%88%86%E7%B1%BB/">82.贝叶斯分类</a></li>
<li><a href="/python100days/docs/Day76-90/83-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/">83.支持向量机</a></li>
<li><a href="/python100days/docs/Day76-90/84-K-%E5%9D%87%E5%80%BC%E8%81%9A%E7%B1%BB/">84.K-均值聚类</a></li>
<li><a href="/python100days/docs/Day76-90/85-%E5%9B%9E%E5%BD%92%E5%88%86%E6%9E%90/">85.回归分析</a></li>
<li><a href="/python100days/docs/Day76-90/86-%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%A5%E9%97%A8/">86.大数据分析入门</a></li>
<li><a href="/python100days/docs/Day76-90/87-%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E8%BF%9B%E9%98%B6/">87.大数据分析进阶</a></li>
<li><a href="/python100days/docs/Day76-90/88-Tensorflow%E5%85%A5%E9%97%A8/">88.Tensorflow入门</a></li>
<li><a href="/python100days/docs/Day76-90/89-Tensorflow%E5%AE%9E%E6%88%98/">89.Tensorflow实战</a></li>
<li><a href="/python100days/docs/Day76-90/90-%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E5%AE%9E%E6%88%98/">90.推荐系统实战</a></li>
</ul></li>
<li><strong>Day91-100</strong>

<ul>
<li><a href="/python100days/docs/Day91-100/91-%E5%9B%A2%E9%98%9F%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%87%86%E5%A4%87/">91.团队项目开发准备</a></li>
<li><a href="/python100days/docs/Day91-100/92-%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1/">92.使用Docker部署服务</a></li>
<li><a href="/python100days/docs/Day91-100/93-MySQL%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">93.MySQL性能优化</a></li>
<li><a href="/python100days/docs/Day91-100/94-%E7%BD%91%E7%BB%9CAPI%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1/">94.网络API接口设计</a></li>
<li><a href="/python100days/docs/Day91-100/95-%E4%BD%BF%E7%94%A8Django%E5%BC%80%E5%8F%91%E5%95%86%E4%B8%9A%E9%A1%B9%E7%9B%AE/">95.使用Django开发商业项目</a></li>
<li><a href="/python100days/docs/Day91-100/96-%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E5%92%8C%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">96.软件测试和自动化测试</a></li>
<li><a href="/python100days/docs/Day91-100/97-%E7%94%B5%E5%95%86%E7%BD%91%E7%AB%99%E6%8A%80%E6%9C%AF%E8%A6%81%E7%82%B9%E5%89%96%E6%9E%90/">97.电商网站技术要点剖析</a></li>
<li><a href="/python100days/docs/Day91-100/98-%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF%E5%92%8C%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/">98.项目部署上线和性能调优</a></li>
<li><a href="/python100days/docs/Day91-100/99-%E9%9D%A2%E8%AF%95%E4%B8%AD%E7%9A%84%E5%85%AC%E5%85%B1%E9%97%AE%E9%A2%98/">99.面试中的公共问题</a></li>
<li><a href="/python100days/docs/Day91-100/100-%E8%8B%B1%E8%AF%AD%E9%9D%A2%E8%AF%95/">100.英语面试</a></li>
</ul></li>
</ul>







</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/python100days/svg/menu.svg" alt="Menu" />
  </label>
  <strong>39 40 No S Q L入门</strong>
</header>

      
<article class="markdown">

<h1 id="nosql入门">NoSQL入门</h1>

<h2 id="nosql概述">NoSQL概述</h2>

<p>如今，大多数的计算机系统（包括服务器、PC、移动设备等）都会产生庞大的数据量。其实，早在2012年的时候，全世界每天产生的数据量就达到了2.5EB（艾字节，$$1EB\approx10^{18}B$$）。这些数据有很大一部分是由关系型数据库来存储和管理的。 早在1970年，E.F.Codd发表了论述关系型数据库的著名论文“*A relational model of data for large shared data banks*”，这篇文章奠定了关系型数据库的基础并在接下来的数十年时间内产生了深远的影响。实践证明，关系型数据库是实现数据持久化最为重要的方式，它也是大多数应用在选择持久化方案时的首选技术。</p>

<p>NoSQL是一项全新的数据库革命性运动，虽然它的历史可以追溯到1998年，但是NoSQL真正深入人心并得到广泛的应用是在进入大数据时候以后，业界普遍认为NoSQL是更适合大数据存储的技术方案，这才使得NoSQL的发展达到了前所未有的高度。2012年《纽约时报》的一篇专栏中写到，大数据时代已经降临，在商业、经济及其他领域中，决策将不再基于经验和直觉而是基于数据和分析而作出。事实上，在天文学、气象学、基因组学、生物学、社会学、互联网搜索引擎、金融、医疗、社交网络、电子商务等诸多领域，由于数据过于密集和庞大，在数据的分析和处理上也遇到了前所未有的限制和阻碍，这一切都使得对大数据处理技术的研究被提升到了新的高度，也使得各种NoSQL的技术方案进入到了公众的视野。</p>

<p>NoSQL数据库按照其存储类型可以大致分为以下几类：</p>

<table>
<thead>
<tr>
<th>类型</th>
<th>部分代表</th>
<th>特点</th>
</tr>
</thead>

<tbody>
<tr>
<td>列族数据库</td>
<td>HBase<br>Cassandra<br>Hypertable</td>
<td>顾名思义是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的I/O优势，适合于批量数据处理和即时查询。</td>
</tr>

<tr>
<td>文档数据库</td>
<td>MongoDB<br>CouchDB<br>ElasticSearch</td>
<td>文档数据库一般用类JSON格式存储数据，存储的内容是文档型的。这样也就有机会对某些字段建立索引，实现关系数据库的某些功能，但不提供对参照完整性和分布事务的支持。</td>
</tr>

<tr>
<td>KV数据库</td>
<td>DynamoDB<br>Redis<br>LevelDB</td>
<td>可以通过key快速查询到其value，有基于内存和基于磁盘两种实现方案。</td>
</tr>

<tr>
<td>图数据库</td>
<td>Neo4J<br>FlockDB<br>JanusGraph</td>
<td>使用图结构进行语义查询的数据库，它使用节点、边和属性来表示和存储数据。图数据库从设计上，就可以简单快速的检索难以在关系系统中建模的复杂层次结构。</td>
</tr>

<tr>
<td>对象数据库</td>
<td>db4o<br>Versant</td>
<td>通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据。</td>
</tr>
</tbody>
</table>

<blockquote>
<p>说明：想了解更多的NoSQL数据库，可以访问<a href="http://nosql-database.org/">http://nosql-database.org/</a>。</p>
</blockquote>

<h2 id="redis概述">Redis概述</h2>

<p>Redis是一种基于键值对的NoSQL数据库，它提供了对多种数据类型（字符串、哈希、列表、集合、有序集合、位图等）的支持，能够满足很多应用场景的需求。Redis将数据放在内存中，因此读写性能是非常惊人的。与此同时，Redis也提供了持久化机制，能够将内存中的数据保存到硬盘上，在发生意外状况时数据也不会丢掉。此外，Redis还支持键过期、地理信息运算、发布订阅、事务、管道、Lua脚本扩展等功能，总而言之，Redis的功能和性能都非常强大，如果项目中要实现高速缓存和消息队列这样的服务，直接交给Redis就可以了。目前，国内外很多著名的企业和商业项目都使用了Redis，包括：Twitter、Github、StackOverflow、新浪微博、百度、优酷土豆、美团、小米、唯品会等。</p>

<h3 id="redis简介">Redis简介</h3>

<p>2008年，一个名为Salvatore Sanfilippo的程序员为他开发的LLOOGG项目定制了专属的数据库（因为之前他无论怎样优化MySQL，系统性能已经无法再提升了），这项工作的成果就是Redis的初始版本。后来他将Redis的代码放到了全球最大的代码托管平台<a href="https://github.com/antirez/redis">Github</a>，从那以后，Redis引发了大量开发者的好评和关注，继而有数百人参与了Redis的开发和维护，这使得Redis的功能越来越强大和性能越来越好。</p>

<p>Redis是REmote DIctionary Server的缩写，它是一个用ANSI C编写的高性能的key-value存储系统，与其他的key-value存储系统相比，Redis有以下一些特点（也是优点）：</p>

<ul>
<li>Redis的读写性能极高，并且有丰富的特性（发布/订阅、事务、通知等）。</li>
<li>Redis支持数据的持久化（RDB和AOF两种方式），可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。</li>
<li>Redis支持多种数据类型，包括：string、hash、list、set，zset、bitmap、hyperloglog等。</li>
<li>Redis支持主从复制（实现读写分析）以及哨兵模式（监控master是否宕机并自动调整配置）。</li>
<li>Redis支持分布式集群，可以很容易的通过水平扩展来提升系统的整体性能。</li>
<li>Redis基于TCP提供的可靠传输服务进行通信，很多编程语言都提供了Redis客户端支持。</li>
</ul>

<h3 id="redis的应用场景">Redis的应用场景</h3>

<ol>
<li>高速缓存  - 将不常变化但又经常被访问的热点数据放到Redis数据库中，可以大大降低关系型数据库的压力，从而提升系统的响应性能。</li>
<li>排行榜 - 很多网站都有排行榜功能，利用Redis中的列表和有序集合可以非常方便的构造各种排行榜系统。</li>
<li>商品秒杀/投票点赞 - Redis提供了对计数操作的支持，网站上常见的秒杀、点赞等功能都可以利用Redis的计数器通过+1或-1的操作来实现，从而避免了使用关系型数据的<code>update</code>操作。</li>
<li>分布式锁 - 利用Redis可以跨多台服务器实现分布式锁（类似于线程锁，但是能够被多台机器上的多个线程或进程共享）的功能，用于实现一个阻塞式操作。</li>
<li>消息队列 - 消息队列和高速缓存一样，是一个大型网站不可缺少的基础服务，可以实现业务解耦和非实时业务削峰等特性，这些我们都会在后面的项目中为大家展示。</li>
</ol>

<h3 id="redis的安装和配置">Redis的安装和配置</h3>

<p>可以使用Linux系统的包管理工具（如yum）来安装Redis，也可以通过在Redis的<a href="https://redis.io/">官方网站</a>下载Redis的源代码，解压缩解归档之后通过make工具对源代码进行构建并安装，在更新这篇文档时，Redis官方提供的最新稳定版本是<a href="http://download.redis.io/releases/redis-5.0.4.tar.gz">Redis 5.0.4</a>。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">wget http://download.redis.io/releases/redis-5.0.4.tar.gz
gunzip redis-5.0.4.tar.gz
tar -xvf redis-5.0.4.tar
cd redis-5.0.4
make <span style="color:#f92672">&amp;&amp;</span> make install</code></pre></div>
<p>在redis源代码目录下有一个名为redis.conf的配置文件，我们可以先查看一下该文件。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">vim redis.conf</code></pre></div>
<p>配置将Redis服务绑定到指定的IP地址和端口。</p>

<p><img src="Day36-40/res/redis-bind-and-port.png" alt="" /></p>

<p>配置底层有多少个数据库。</p>

<p><img src="Day36-40/res/redis-databases.png" alt="" /></p>

<p>配置Redis的持久化机制 - RDB。</p>

<p><img src="Day36-40/res/redis-rdb-1.png" alt="" /></p>

<p><img src="Day36-40/res/redis-rdb-3.png" alt="" /></p>

<p>配置Redis的持久化机制 - AOF。</p>

<p><img src="Day36-40/res/redis-aof.png" alt="" /></p>

<p>配置访问Redis服务器的验证口令。</p>

<p><img src="Day36-40/res/redis-security.png" alt="" /></p>

<p>配置Redis的主从复制，通过主从复制可以实现读写分离。</p>

<p><img src="Day36-40/res/redis-replication.png" alt="" /></p>

<p>配置慢查询。</p>

<p><img src="Day36-40/res/redis-slow-logs.png" alt="" /></p>

<p>上面这些内容就是Redis的基本配置，如果你对上面的内容感到困惑也没有关系，先把Redis用起来再回头去推敲这些内容就行了。如果想找一些参考书，<a href="https://item.jd.com/12121730.html">《Redis开发与运维》</a>是一本不错的入门读物，而<a href="https://item.jd.com/11791607.html">《Redis实战》</a>是不错的进阶读物。</p>

<h3 id="redis的服务器和客户端">Redis的服务器和客户端</h3>

<p>接下来启动Redis服务器，下面的方式将以默认的配置启动Redis服务。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">redis-server</code></pre></div>
<p>如果希望修改Redis的配置（如端口、认证口令、持久化方式等），可以通过下面两种方式。</p>

<p>方式一：通过参数指定认证口令和AOF持久化方式。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">redis-server --requirepass 1qaz2wsx --appendonly yes</code></pre></div>
<p>方式二：通过指定的配置文件来修改Redis的配置。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">redis-server /root/redis-5.0.4/redis.conf</code></pre></div>
<p>下面我们使用第一种方式来启动Redis并将其置于后台运行，将Redis产生的输出重定向到名为redis.log的文件中。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">redis-server --requirepass 1qaz2wsx &gt; redis.log &amp;</code></pre></div>
<p>可以通过ps或者netstat来检查Redis服务器是否启动成功。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">ps -ef | grep redis-server
netstat -nap | grep redis-server</code></pre></div>
<p>接下来，我们尝试用Redis客户端去连接服务器。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">redis-cli
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; auth 1qaz2wsx
OK
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; ping
PONG
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt;</code></pre></div>
<p>Redis有着非常丰富的数据类型，也有很多的命令来操作这些数据，具体的内容可以查看<a href="http://redisdoc.com/">Redis命令参考</a>，在这个网站上，除了Redis的命令参考，还有Redis的详细文档，其中包括了通知、事务、主从复制、持久化、哨兵、集群等内容。</p>

<p><img src="Day36-40/res/redis-data-types.png" alt="" /></p>

<blockquote>
<p>说明：上面的插图来自付磊和张益军先生编著的《Redis开发与运维》一书。</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell"><span style="color:#ae81ff">127</span>.0.0.1:6379&gt; set username admin
OK
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; get username
<span style="color:#e6db74">&#34;admin&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; set password <span style="color:#e6db74">&#34;123456&#34;</span> ex <span style="color:#ae81ff">300</span>
OK
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; get password
<span style="color:#e6db74">&#34;123456&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; ttl username
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> -1
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; ttl password
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">286</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; hset stu1 name hao
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; hset stu1 age <span style="color:#ae81ff">38</span>
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; hset stu1 gender male
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; hgetall stu1
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;name&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;hao&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;age&#34;</span>
<span style="color:#ae81ff">4</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;38&#34;</span>
<span style="color:#ae81ff">5</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;gender&#34;</span>
<span style="color:#ae81ff">6</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;male&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; hvals stu1
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;hao&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;38&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;male&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; hmset stu2 name wang age <span style="color:#ae81ff">18</span> gender female tel <span style="color:#ae81ff">13566778899</span>
OK
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; hgetall stu2
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;name&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;wang&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;age&#34;</span>
<span style="color:#ae81ff">4</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;18&#34;</span>
<span style="color:#ae81ff">5</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;gender&#34;</span>
<span style="color:#ae81ff">6</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;female&#34;</span>
<span style="color:#ae81ff">7</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;tel&#34;</span>
<span style="color:#ae81ff">8</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;13566778899&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; lpush nums <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span>
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; lrange nums <span style="color:#ae81ff">0</span> -1
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;5&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;4&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;3&#34;</span>
<span style="color:#ae81ff">4</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;2&#34;</span>
<span style="color:#ae81ff">5</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;1&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; lpop nums
<span style="color:#e6db74">&#34;5&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; lpop nums
<span style="color:#e6db74">&#34;4&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; rpop nums
<span style="color:#e6db74">&#34;1&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; rpop nums
<span style="color:#e6db74">&#34;2&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sadd fruits apple banana orange apple grape grape
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; scard fruits
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; smembers fruits
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;grape&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;orange&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;banana&#34;</span>
<span style="color:#ae81ff">4</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;apple&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sismember fruits apple
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">1</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sismember fruits durian
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sadd nums1 <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">5</span>
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sadd nums2 <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">4</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">8</span>
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sinter nums1 nums2
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;2&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;4&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sunion nums1 nums2
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;1&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;2&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;3&#34;</span>
<span style="color:#ae81ff">4</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;4&#34;</span>
<span style="color:#ae81ff">5</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;5&#34;</span>
<span style="color:#ae81ff">6</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;6&#34;</span>
<span style="color:#ae81ff">7</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;8&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; sdiff nums1 nums2
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;1&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;3&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;5&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; zadd topsinger <span style="color:#ae81ff">5234</span> zhangxy <span style="color:#ae81ff">1978</span> chenyx <span style="color:#ae81ff">2235</span> zhoujl <span style="color:#ae81ff">3520</span> xuezq
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">4</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; zrange topsinger <span style="color:#ae81ff">0</span> -1 withscores
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;chenyx&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;1978&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;zhoujl&#34;</span>
<span style="color:#ae81ff">4</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;2235&#34;</span>
<span style="color:#ae81ff">5</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;xuezq&#34;</span>
<span style="color:#ae81ff">6</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;3520&#34;</span>
<span style="color:#ae81ff">7</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;zhangxy&#34;</span>
<span style="color:#ae81ff">8</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;5234&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; zrevrange topsinger <span style="color:#ae81ff">0</span> -1
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;zhangxy&#34;</span>
<span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;xuezq&#34;</span>
<span style="color:#ae81ff">3</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;zhoujl&#34;</span>
<span style="color:#ae81ff">4</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;chenyx&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; geoadd pois <span style="color:#ae81ff">116</span>.39738549206541 <span style="color:#ae81ff">39</span>.90862689286386 tiananmen <span style="color:#ae81ff">116</span>.27172936413572 <span style="color:#ae81ff">39</span>.99
<span style="color:#ae81ff">135172904494</span> yiheyuan <span style="color:#ae81ff">117</span>.27766503308104 <span style="color:#ae81ff">40</span>.65332064313784 gubeishuizhen
<span style="color:#f92672">(</span>integer<span style="color:#f92672">)</span> <span style="color:#ae81ff">3</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; geodist pois tiananmen gubeishuizhen km
<span style="color:#e6db74">&#34;111.5333&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; geodist pois tiananmen yiheyuan km
<span style="color:#e6db74">&#34;14.1230&#34;</span>
<span style="color:#ae81ff">127</span>.0.0.1:6379&gt; georadius pois <span style="color:#ae81ff">116</span>.86499108288572 <span style="color:#ae81ff">40</span>.40149669363615 <span style="color:#ae81ff">50</span> km withdist
<span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;gubeishuizhen&#34;</span>
   <span style="color:#ae81ff">2</span><span style="color:#f92672">)</span> <span style="color:#e6db74">&#34;44.7408&#34;</span></code></pre></div>
<h3 id="在python程序中使用redis">在Python程序中使用Redis</h3>

<p>可以使用pip安装redis模块。redis模块的核心是名为Redis的类，该类的对象代表一个Redis客户端，通过该客户端可以向Redis服务器发送命令并获取执行的结果。上面我们在Redis客户端中使用的命令基本上就是Redis对象可以接收的消息，所以如果了解了Redis的命令就可以在Python中玩转Redis。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">pip3 install redis
python3</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python" data-lang="Python"><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> redis
<span style="color:#f92672">&gt;&gt;&gt;</span> client <span style="color:#f92672">=</span> redis<span style="color:#f92672">.</span>Redis(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1.2.3.4&#39;</span>, port<span style="color:#f92672">=</span><span style="color:#ae81ff">6379</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;1qaz2wsx&#39;</span>)
<span style="color:#f92672">&gt;&gt;&gt;</span> client<span style="color:#f92672">.</span>set(<span style="color:#e6db74">&#39;username&#39;</span>, <span style="color:#e6db74">&#39;admin&#39;</span>)
True
<span style="color:#f92672">&gt;&gt;&gt;</span> client<span style="color:#f92672">.</span>hset(<span style="color:#e6db74">&#39;student&#39;</span>, <span style="color:#e6db74">&#39;name&#39;</span>, <span style="color:#e6db74">&#39;hao&#39;</span>)
<span style="color:#ae81ff">1</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> client<span style="color:#f92672">.</span>hset(<span style="color:#e6db74">&#39;student&#39;</span>, <span style="color:#e6db74">&#39;age&#39;</span>, <span style="color:#ae81ff">38</span>)
<span style="color:#ae81ff">1</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> client<span style="color:#f92672">.</span>keys(<span style="color:#e6db74">&#39;*&#39;</span>)
[<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;username&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;student&#39;</span>]
<span style="color:#f92672">&gt;&gt;&gt;</span> client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;username&#39;</span>)
<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;admin&#39;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> client<span style="color:#f92672">.</span>hgetall(<span style="color:#e6db74">&#39;student&#39;</span>)
{<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;hao&#39;</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;age&#39;</span>: <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;38&#39;</span>}</code></pre></div>
<h2 id="mongodb概述">MongoDB概述</h2>

<h3 id="mongodb简介">MongoDB简介</h3>

<p>MongoDB是2009年问世的一个面向文档的数据库管理系统，由C++语言编写，旨在为Web应用提供可扩展的高性能数据存储解决方案。虽然在划分类别的时候后，MongoDB被认为是NoSQL的产品，但是它更像一个介于关系数据库和非关系数据库之间的产品，在非关系数据库中它功能最丰富，最像关系数据库。</p>

<p>MongoDB将数据存储为一个文档，一个文档由一系列的“键值对”组成，其文档类似于JSON对象，但是MongoDB对JSON进行了二进制处理（能够更快的定位key和value），因此其文档的存储格式称为BSON。关于JSON和BSON的差别大家可以看看MongoDB官方网站的文章<a href="https://www.mongodb.com/json-and-bson">《JSON and BSON》</a>。</p>

<p>目前，MongoDB已经提供了对Windows、MacOS、Linux、Solaris等多个平台的支持，而且也提供了多种开发语言的驱动程序，Python当然是其中之一。</p>

<h3 id="mongodb的安装和配置">MongoDB的安装和配置</h3>

<p>可以从MongoDB的<a href="https://www.mongodb.com/download-center#community">官方下载链接</a>下载MongoDB，官方为Windows系统提供了一个Installer程序，而Linux和MacOS则提供了压缩文件。下面简单说一下Linux系统如何安装和配置MongoDB。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">wget https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-amazon-3.6.5.tgz
gunzip mongodb-linux-x86_64-amazon-3.6.5.tgz
mkdir mongodb-3.6.5
tar -xvf mongodb-linux-x86_64-amazon-3.6.5.tar --strip-components <span style="color:#ae81ff">1</span> -C mongodb-3.6.5/
export PATH<span style="color:#f92672">=</span>$PATH:~/mongodb-3.6.5/bin
mkdir -p /data/db
mongod --bind_ip <span style="color:#ae81ff">172</span>.18.61.250

<span style="color:#ae81ff">2018</span>-06-03T18:03:28.232+0800 I CONTROL  <span style="color:#f92672">[</span>initandlisten<span style="color:#f92672">]</span> MongoDB starting : pid<span style="color:#f92672">=</span><span style="color:#ae81ff">1163</span> port<span style="color:#f92672">=</span><span style="color:#ae81ff">27017</span> dbpath<span style="color:#f92672">=</span>/data/db <span style="color:#ae81ff">64</span>-bit host<span style="color:#f92672">=</span>iZwz97tbgo9lkabnat2lo8Z
<span style="color:#ae81ff">2018</span>-06-03T18:03:28.232+0800 I CONTROL  <span style="color:#f92672">[</span>initandlisten<span style="color:#f92672">]</span> db version v3.6.5
<span style="color:#ae81ff">2018</span>-06-03T18:03:28.232+0800 I CONTROL  <span style="color:#f92672">[</span>initandlisten<span style="color:#f92672">]</span> git version: a20ecd3e3a174162052ff99913bc2ca9a839d618
<span style="color:#ae81ff">2018</span>-06-03T18:03:28.232+0800 I CONTROL  <span style="color:#f92672">[</span>initandlisten<span style="color:#f92672">]</span> OpenSSL version: OpenSSL <span style="color:#ae81ff">1</span>.0.0-fips29 Mar <span style="color:#ae81ff">2010</span>
...
<span style="color:#ae81ff">2018</span>-06-03T18:03:28.945+0800 I NETWORK  <span style="color:#f92672">[</span>initandlisten<span style="color:#f92672">]</span> waiting <span style="color:#66d9ef">for</span> connections on port <span style="color:#ae81ff">27017</span></code></pre></div>
<blockquote>
<p>说明：上面的操作中，export命令是设置PATH环境变量，这样可以在任意路径下执行mongod来启动MongoDB服务器。MongoDB默认保存数据的路径是/data/db目录，为此要提前创建该目录。此外，在使用mongod启动MongoDB服务器时，&ndash;bind_ip参数用来将服务绑定到指定的IP地址，也可以用&ndash;port参数来指定端口，默认端口为27017。</p>
</blockquote>

<h3 id="mongodb基本概念">MongoDB基本概念</h3>

<p>我们通过与关系型数据库进行对照的方式来说明MongoDB中的一些概念。</p>

<table>
<thead>
<tr>
<th>SQL</th>
<th>MongoDB</th>
<th>解释（SQL/MongoDB）</th>
</tr>
</thead>

<tbody>
<tr>
<td>database</td>
<td>database</td>
<td>数据库/数据库</td>
</tr>

<tr>
<td>table</td>
<td>collection</td>
<td>二维表/集合</td>
</tr>

<tr>
<td>row</td>
<td>document</td>
<td>记录（行）/文档</td>
</tr>

<tr>
<td>column</td>
<td>field</td>
<td>字段（列）/域</td>
</tr>

<tr>
<td>index</td>
<td>index</td>
<td>索引/索引</td>
</tr>

<tr>
<td>table joins</td>
<td>&mdash;</td>
<td>表连接/嵌套文档</td>
</tr>

<tr>
<td>primary key</td>
<td>primary key</td>
<td>主键/主键（<code>_id</code>字段）</td>
</tr>
</tbody>
</table>

<h3 id="通过shell操作mongodb">通过Shell操作MongoDB</h3>

<p>启动服务器后可以使用交互式环境跟服务器通信，如下所示。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">mongo --host <span style="color:#ae81ff">172</span>.18.61.250

MongoDB shell version v3.6.5
connecting to: mongodb://172.18.61.250:27017/</code></pre></div>
<ol>
<li><p>查看、创建和删除数据库。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JavaScript" data-lang="JavaScript"><span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 显示所有数据库
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">show</span> <span style="color:#a6e22e">dbs</span>
<span style="color:#a6e22e">admin</span>   <span style="color:#ae81ff">0.000</span><span style="color:#a6e22e">GB</span>
<span style="color:#a6e22e">config</span>  <span style="color:#ae81ff">0.000</span><span style="color:#a6e22e">GB</span>
<span style="color:#a6e22e">local</span>   <span style="color:#ae81ff">0.000</span><span style="color:#a6e22e">GB</span>
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 创建并切换到school数据库
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">use</span> <span style="color:#a6e22e">school</span>
<span style="color:#a6e22e">switched</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">db</span> <span style="color:#a6e22e">school</span>
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 删除当前数据库
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">dropDatabase</span>()
{ <span style="color:#e6db74">&#34;ok&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> }
<span style="color:#f92672">&gt;</span>
</code></pre></div></li>

<li><p>创建、删除和查看集合。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JavaScript" data-lang="JavaScript"><span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 创建并切换到school数据库
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">use</span> <span style="color:#a6e22e">school</span>
<span style="color:#a6e22e">switched</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">db</span> <span style="color:#a6e22e">school</span>
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 创建colleges集合
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">createCollection</span>(<span style="color:#e6db74">&#39;colleges&#39;</span>)
{ <span style="color:#e6db74">&#34;ok&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> }
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 创建students集合
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">createCollection</span>(<span style="color:#e6db74">&#39;students&#39;</span>)
{ <span style="color:#e6db74">&#34;ok&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> }
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 查看所有集合
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">show</span> <span style="color:#a6e22e">collections</span>
<span style="color:#a6e22e">colleges</span>
<span style="color:#a6e22e">students</span>
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 删除colleges集合
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">colleges</span>.<span style="color:#a6e22e">drop</span>()
<span style="color:#66d9ef">true</span>
<span style="color:#f92672">&gt;</span>
</code></pre></div></li>
</ol>

<blockquote>
<p>说明：在MongoDB中插入文档时如果集合不存在会自动创建集合，所以也可以按照下面的方式通过创建文档来创建集合。</p>
</blockquote>

<ol>
<li><p>文档的CRUD操作。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JavaScript" data-lang="JavaScript"><span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 向students集合插入文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">insert</span>({<span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>, <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;骆昊&#39;</span>, <span style="color:#a6e22e">age</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">38</span>})
<span style="color:#a6e22e">WriteResult</span>({ <span style="color:#e6db74">&#34;nInserted&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> })
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 向students集合插入文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">save</span>({<span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1002</span>, <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;王大锤&#39;</span>, <span style="color:#a6e22e">tel</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;13012345678&#39;</span>, <span style="color:#a6e22e">gender</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;男&#39;</span>})
<span style="color:#a6e22e">WriteResult</span>({ <span style="color:#e6db74">&#34;nInserted&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> })
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 查看所有文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">find</span>()
{ <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c72e006ad854460ee70b&#34;</span>), <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>, <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;骆昊&#34;</span>, <span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">38</span> }
{ <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c790006ad854460ee70c&#34;</span>), <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1002</span>, <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;王大锤&#34;</span>, <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13012345678&#34;</span>, <span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;男&#34;</span> }
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 更新stuid为1001的文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">update</span>({<span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>}, {<span style="color:#e6db74">&#39;$set&#39;</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">tel</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;13566778899&#39;</span>, <span style="color:#a6e22e">gender</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;男&#39;</span>}})
<span style="color:#a6e22e">WriteResult</span>({ <span style="color:#e6db74">&#34;nMatched&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;nUpserted&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;nModified&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> })
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 插入或更新stuid为1003的文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">update</span>({<span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1003</span>}, {<span style="color:#e6db74">&#39;$set&#39;</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;白元芳&#39;</span>, <span style="color:#a6e22e">tel</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;13022223333&#39;</span>, <span style="color:#a6e22e">gender</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;男&#39;</span>}},  <span style="color:#a6e22e">upsert</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>)
<span style="color:#a6e22e">WriteResult</span>({
       <span style="color:#e6db74">&#34;nMatched&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
       <span style="color:#e6db74">&#34;nUpserted&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
       <span style="color:#e6db74">&#34;nModified&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
       <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c92dd185894d7283efab&#34;</span>)
})
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 查询所有文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">find</span>().<span style="color:#a6e22e">pretty</span>()
{
       <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c72e006ad854460ee70b&#34;</span>),
       <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>,
       <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;骆昊&#34;</span>,
       <span style="color:#e6db74">&#34;age&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">38</span>,
       <span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;男&#34;</span>,
       <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13566778899&#34;</span>
}
{
       <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c790006ad854460ee70c&#34;</span>),
       <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1002</span>,
       <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;王大锤&#34;</span>,
       <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13012345678&#34;</span>,
       <span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;男&#34;</span>
}
{
       <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c92dd185894d7283efab&#34;</span>),
       <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1003</span>,
       <span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;男&#34;</span>,
       <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;白元芳&#34;</span>,
       <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13022223333&#34;</span>
}
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 查询stuid大于1001的文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">find</span>({<span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> {<span style="color:#e6db74">&#39;$gt&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>}}).<span style="color:#a6e22e">pretty</span>()
{
       <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c790006ad854460ee70c&#34;</span>),
       <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1002</span>,
       <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;王大锤&#34;</span>,
       <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13012345678&#34;</span>,
       <span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;男&#34;</span>
}
{
       <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c92dd185894d7283efab&#34;</span>),
       <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1003</span>,
       <span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;男&#34;</span>,
       <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;白元芳&#34;</span>,
       <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13022223333&#34;</span>
}
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 查询stuid大于1001的文档只显示name和tel字段
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">find</span>({<span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> {<span style="color:#e6db74">&#39;$gt&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>}}, {<span style="color:#a6e22e">_id</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">tel</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>}).<span style="color:#a6e22e">pretty</span>()
{ <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;王大锤&#34;</span>, <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13012345678&#34;</span> }
{ <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;白元芳&#34;</span>, <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13022223333&#34;</span> }
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 查询name为“骆昊”或者tel为“13022223333”的文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">find</span>({<span style="color:#e6db74">&#39;$or&#39;</span><span style="color:#f92672">:</span> [{<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;骆昊&#39;</span>}, {<span style="color:#a6e22e">tel</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;13022223333&#39;</span>}]}, {<span style="color:#a6e22e">_id</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">tel</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>}).<span style="color:#a6e22e">pretty</span>()
{ <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;骆昊&#34;</span>, <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13566778899&#34;</span> }
{ <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;白元芳&#34;</span>, <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13022223333&#34;</span> }
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 查询学生文档跳过第1条文档只查1条文档
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">find</span>().<span style="color:#a6e22e">skip</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">limit</span>(<span style="color:#ae81ff">1</span>).<span style="color:#a6e22e">pretty</span>()
{
       <span style="color:#e6db74">&#34;_id&#34;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ObjectId</span>(<span style="color:#e6db74">&#34;5b13c790006ad854460ee70c&#34;</span>),
       <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1002</span>,
       <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;王大锤&#34;</span>,
       <span style="color:#e6db74">&#34;tel&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;13012345678&#34;</span>,
       <span style="color:#e6db74">&#34;gender&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;男&#34;</span>
}
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 对查询结果进行排序(1表示升序，-1表示降序)
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">find</span>({}, {<span style="color:#a6e22e">_id</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>}).<span style="color:#a6e22e">sort</span>({<span style="color:#a6e22e">stuid</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>})
{ <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1003</span>, <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;白元芳&#34;</span> }
{ <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1002</span>, <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;王大锤&#34;</span> }
{ <span style="color:#e6db74">&#34;stuid&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1001</span>, <span style="color:#e6db74">&#34;name&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;骆昊&#34;</span> }
<span style="color:#f92672">&gt;</span> <span style="color:#75715e">// 在指定的一个或多个字段上创建索引
</span><span style="color:#75715e"></span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">students</span>.<span style="color:#a6e22e">ensureIndex</span>({<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>})
{
       <span style="color:#e6db74">&#34;createdCollectionAutomatically&#34;</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span>,
       <span style="color:#e6db74">&#34;numIndexesBefore&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
       <span style="color:#e6db74">&#34;numIndexesAfter&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>,
       <span style="color:#e6db74">&#34;ok&#34;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
}
<span style="color:#f92672">&gt;</span>
</code></pre></div></li>
</ol>

<p>使用MongoDB可以非常方便的配置数据复制，通过冗余数据来实现数据的高可用以及灾难恢复，也可以通过数据分片来应对数据量迅速增长的需求。关于MongoDB更多的操作可以查阅<a href="https://mongodb-documentation.readthedocs.io/en/latest/">官方文档</a> ，同时推荐大家阅读Kristina Chodorow写的<a href="http://www.ituring.com.cn/book/1172">《MongoDB权威指南》</a>。</p>

<h3 id="在python程序中操作mongodb">在Python程序中操作MongoDB</h3>

<p>可以通过pip安装pymongo来实现对MongoDB的操作。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Shell" data-lang="Shell">pip3 install pymongo
python3</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python" data-lang="Python"><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">from</span> pymongo <span style="color:#f92672">import</span> MongoClient
<span style="color:#f92672">&gt;&gt;&gt;</span> client <span style="color:#f92672">=</span> MongoClient(<span style="color:#e6db74">&#39;mongodb://127.0.0.1:27017&#39;</span>)
<span style="color:#f92672">&gt;&gt;&gt;</span> db <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>school
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">for</span> student <span style="color:#f92672">in</span> db<span style="color:#f92672">.</span>students<span style="color:#f92672">.</span>find():
<span style="color:#f92672">...</span>     <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;学号:&#39;</span>, student[<span style="color:#e6db74">&#39;stuid&#39;</span>])
<span style="color:#f92672">...</span>     <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;姓名:&#39;</span>, student[<span style="color:#e6db74">&#39;name&#39;</span>])
<span style="color:#f92672">...</span>     <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;电话:&#39;</span>, student[<span style="color:#e6db74">&#39;tel&#39;</span>])
<span style="color:#f92672">...</span>
<span style="color:#960050;background-color:#1e0010">学号</span>: <span style="color:#ae81ff">1001.0</span>
<span style="color:#960050;background-color:#1e0010">姓名</span>: <span style="color:#960050;background-color:#1e0010">骆昊</span>
<span style="color:#960050;background-color:#1e0010">电话</span>: <span style="color:#ae81ff">13566778899</span>
<span style="color:#960050;background-color:#1e0010">学号</span>: <span style="color:#ae81ff">1002.0</span>
<span style="color:#960050;background-color:#1e0010">姓名</span>: <span style="color:#960050;background-color:#1e0010">王大锤</span>
<span style="color:#960050;background-color:#1e0010">电话</span>: <span style="color:#ae81ff">13012345678</span>
<span style="color:#960050;background-color:#1e0010">学号</span>: <span style="color:#ae81ff">1003.0</span>
<span style="color:#960050;background-color:#1e0010">姓名</span>: <span style="color:#960050;background-color:#1e0010">白元芳</span>
<span style="color:#960050;background-color:#1e0010">电话</span>: <span style="color:#ae81ff">13022223333</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> db<span style="color:#f92672">.</span>students<span style="color:#f92672">.</span>find()<span style="color:#f92672">.</span>count()
<span style="color:#ae81ff">3</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> db<span style="color:#f92672">.</span>students<span style="color:#f92672">.</span>remove()
{<span style="color:#e6db74">&#39;n&#39;</span>: <span style="color:#ae81ff">3</span>, <span style="color:#e6db74">&#39;ok&#39;</span>: <span style="color:#ae81ff">1.0</span>}
<span style="color:#f92672">&gt;&gt;&gt;</span> db<span style="color:#f92672">.</span>students<span style="color:#f92672">.</span>find()<span style="color:#f92672">.</span>count()
<span style="color:#ae81ff">0</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> coll <span style="color:#f92672">=</span> db<span style="color:#f92672">.</span>students
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">from</span> pymongo <span style="color:#f92672">import</span> ASCENDING
<span style="color:#f92672">&gt;&gt;&gt;</span> coll<span style="color:#f92672">.</span>create_index([(<span style="color:#e6db74">&#39;name&#39;</span>, ASCENDING)], unique<span style="color:#f92672">=</span>True)
<span style="color:#e6db74">&#39;name_1&#39;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> coll<span style="color:#f92672">.</span>insert_one({<span style="color:#e6db74">&#39;stuid&#39;</span>: int(<span style="color:#ae81ff">1001</span>), <span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;骆昊&#39;</span>, <span style="color:#e6db74">&#39;gender&#39;</span>: True})
<span style="color:#f92672">&lt;</span>pymongo<span style="color:#f92672">.</span>results<span style="color:#f92672">.</span>InsertOneResult object at <span style="color:#ae81ff">0x1050cc6c8</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> coll<span style="color:#f92672">.</span>insert_many([{<span style="color:#e6db74">&#39;stuid&#39;</span>: int(<span style="color:#ae81ff">1002</span>), <span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;王大锤&#39;</span>, <span style="color:#e6db74">&#39;gender&#39;</span>: False}, {<span style="color:#e6db74">&#39;stuid&#39;</span>: int(<span style="color:#ae81ff">1003</span>), <span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;白元芳&#39;</span>, <span style="color:#e6db74">&#39;gender&#39;</span>: True}])
<span style="color:#f92672">&lt;</span>pymongo<span style="color:#f92672">.</span>results<span style="color:#f92672">.</span>InsertManyResult object at <span style="color:#ae81ff">0x1050cc8c8</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#66d9ef">for</span> student <span style="color:#f92672">in</span> coll<span style="color:#f92672">.</span>find({<span style="color:#e6db74">&#39;gender&#39;</span>: True}):
<span style="color:#f92672">...</span>     <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;学号:&#39;</span>, student[<span style="color:#e6db74">&#39;stuid&#39;</span>])
<span style="color:#f92672">...</span>     <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;姓名:&#39;</span>, student[<span style="color:#e6db74">&#39;name&#39;</span>])
<span style="color:#f92672">...</span>     <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;性别:&#39;</span>, <span style="color:#e6db74">&#39;男&#39;</span> <span style="color:#66d9ef">if</span> student[<span style="color:#e6db74">&#39;gender&#39;</span>] <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#39;女&#39;</span>)
<span style="color:#f92672">...</span>
<span style="color:#960050;background-color:#1e0010">学号</span>: <span style="color:#ae81ff">1001</span>
<span style="color:#960050;background-color:#1e0010">姓名</span>: <span style="color:#960050;background-color:#1e0010">骆昊</span>
<span style="color:#960050;background-color:#1e0010">性别</span>: <span style="color:#960050;background-color:#1e0010">男</span>
<span style="color:#960050;background-color:#1e0010">学号</span>: <span style="color:#ae81ff">1003</span>
<span style="color:#960050;background-color:#1e0010">姓名</span>: <span style="color:#960050;background-color:#1e0010">白元芳</span>
<span style="color:#960050;background-color:#1e0010">性别</span>: <span style="color:#960050;background-color:#1e0010">男</span>
<span style="color:#f92672">&gt;&gt;&gt;</span></code></pre></div>
<p>关于PyMongo更多的知识可以通过它的<a href="https://api.mongodb.com/python/current/tutorial.html">官方文档</a>进行了解，也可以使用<a href="https://pypi.org/project/mongoengine/">MongoEngine</a>这样的库来简化Python程序对MongoDB的操作，除此之外，还有以异步I/O方式访问MongoDB的三方库<a href="https://pypi.org/project/motor/">motor</a>都是不错的选择。</p>
</article>

      

      
    </div>

    
  

  <aside class="book-toc level-3 fixed">
    <nav id="TableOfContents">
<ul>
<li><a href="#nosql入门">NoSQL入门</a>
<ul>
<li><a href="#nosql概述">NoSQL概述</a></li>
<li><a href="#redis概述">Redis概述</a>
<ul>
<li><a href="#redis简介">Redis简介</a></li>
<li><a href="#redis的应用场景">Redis的应用场景</a></li>
<li><a href="#redis的安装和配置">Redis的安装和配置</a></li>
<li><a href="#redis的服务器和客户端">Redis的服务器和客户端</a></li>
<li><a href="#在python程序中使用redis">在Python程序中使用Redis</a></li>
</ul></li>
<li><a href="#mongodb概述">MongoDB概述</a>
<ul>
<li><a href="#mongodb简介">MongoDB简介</a></li>
<li><a href="#mongodb的安装和配置">MongoDB的安装和配置</a></li>
<li><a href="#mongodb基本概念">MongoDB基本概念</a></li>
<li><a href="#通过shell操作mongodb">通过Shell操作MongoDB</a></li>
<li><a href="#在python程序中操作mongodb">在Python程序中操作MongoDB</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </aside>



  </main>

  
  
</body>

</html>
